<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to ggplot</title>
    <meta charset="utf-8" />
    <meta name="author" content="36-290 – Statistical Research Methodology" />
    <script src="Notes_02R-Rggplot_files/header-attrs-2.10/header-attrs.js"></script>
    <link href="Notes_02R-Rggplot_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="Notes_02R-Rggplot_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introduction to ggplot
### 36-290 – Statistical Research Methodology
### Week 2 Thursday – Fall 2021

---


&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 16px;
    padding: 1em 4em 1em 4em;
}
.remark-code {
    font-size: 12px;
}
&lt;/style&gt;

&lt;style type="text/css"&gt;
table {
  font-size: 12px;
}
&lt;/style&gt;

## Preliminaries

Let's read in the data frame that we use in the `dplyr` notes set:

```r
df = read.csv("http://www.stat.cmu.edu/~pfreeman/GalaxyMass.csv")
```
As a reminder, these data consist of 3456 rows and 10 columns with names

```r
names(df)
```

```
##  [1] "field"  "Gini"   "M20"    "C"      "A"      "size"   "n"      "q"      "z.mode" "mass"
```

---

## ggplot

`ggplot` (actually, and perhaps confusingly, `ggplot2`) is "a system for declaratively creating graphics, based on [The Grammar of Graphics](https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448/ref=as_li_ss_tl?ie=UTF8&amp;qid=1477928463&amp;sr=8-1&amp;keywords=the+grammar+of+graphics&amp;linkCode=sl1&amp;tag=ggplot2-20&amp;linkId=f0130e557161b83fbe97ba0e9175c431). You provide the data [frame], tell `ggplot2` how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details."

Sounds good. Let's dive in:

```r
library(ggplot2)    # also loaded as part of the tidyverse
```

---

## ggplot: Basic Structure

A very basic call to `ggplot()` has the following structure:
```
ggplot(data=&lt;data frame&gt;,mapping=aes(x=&lt;x axis variable&gt;,...)) + geom_&lt;plot type&gt;(&lt;arguments&gt;)
```
For instance, to plot `z.mode` vs. `mass` (and remember: we plot `\(y\)` vs. `\(x\)`):

```r
ggplot(data=df,mapping=aes(x=mass,y=z.mode)) + geom_point(color="red")
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;
We'll talk more about two-dimensional scatter plots and such in another set of notes. Here, we'll concentrate on univariate (one-dimensional) plots.

---

## ggplot: Bar Chart

How many galaxies are in each field?

```r
ggplot(data=df,mapping=aes(x=field)) + geom_bar(color="red",fill="blue")
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;
(A bar chart is appropriate when the x-axis variable is categorical and the y-axis variable is quantitative.)

---

## ggplot: Histogram

What is the distribution of galaxy sizes?

```r
ggplot(data=df,mapping=aes(x=size)) + geom_histogram(color="blue",bins=25)
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /&gt;
(A histogram is appropriate when the single variable in question is quantitative.)

---

## ggplot: Boxplot

Boxplots are just a bit trickier. What is the distribution of galaxy concentrations?

```r
ggplot(data=df,mapping=aes(x="",y=C)) + geom_boxplot(color="blue",fill="orange")
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;
(A boxplot is also for visualizing a quantitative variable.)

---

## ggplot: Faceting

Faceting is the act of making multiple plots at once that appear side-by-side as "facets". Faceting is something you might want to do when, e.g., you have a factor variable. Here, we show histograms of the concentration variable `C` broken up by galaxy field.

```r
ggplot(data=df,mapping=aes(x=C)) + geom_histogram(color="blue",fill="yellow",bins=25) +
  facet_wrap(~field,scales='free_x')
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Gather

`gather()` is a function (from the `tidyr` package) that takes a data frame and realigns it. It is best illustrated via a simple example. Let's say we have the following data frame, which we'll call `df`:
```
&gt; df
     x   y
1  0.5 0.7
2  1.2 1.9
```
If we "gather" these data, we get the following:
```
&gt; library(tidyr)
...
&gt; gather(df)
      key  value
1       x    0.5
2       x    1.2
3       y    0.7
4       y    1.9
```
Combining `gather()` with faceting allows one to, e.g., visualize multiple variables at once.

---

## ggplot: Gather (+ dplyr)


```r
suppressMessages(library(tidyr))
suppressMessages(library(magrittr))
suppressMessages(library(dplyr))

df.new = df %&gt;% select(.,z.mode,mass) %&gt;% gather(.)
ggplot(data=df.new,mapping=aes(x=value)) + geom_histogram(color="blue",fill="yellow",bins=25) +
  facet_wrap(~key,scales='free_x')
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Scatter Plot

Let's get a sense of the data by plotting `mass` vs. `C` in a scatter plot:

```r
ggplot(data=df,mapping=aes(x=C,y=mass)) + geom_point(color="red",size=0.5)
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Scatter Plot with Density

By using `geom_density_2d()` we can overlay contours that indicate the density of points:

```r
ggplot(data=df,mapping=aes(x=C,y=mass)) + geom_density_2d() + geom_point(color="red",size=0.5)
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Scatter Plot with Bins

By using `geom_bin2d` we can overlay bins whose color indicates the density of points:

```r
ggplot(data=df,mapping=aes(x=C,y=mass)) + geom_bin2d()
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Scatter Plot with Hexagonal Bins

What about hexagonal bins?

```r
library(hexbin)
ggplot(data=df,mapping=aes(x=C,y=mass)) + geom_hex() + geom_point(color="red",size=0.25)
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: freqpoly

`geom_freqpoly()` is a means by which to overlay empirical distributions of data in one plot pane. For instance, what is the distribution of `mass` as a function of `field`?

```r
ggplot(data=df,mapping=aes(x=mass)) + geom_freqpoly(mapping=aes(color=field))
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /&gt;

---

## ggplot: Overlaid Histograms


```r
ggplot(data=df,mapping=aes(x=C,fill=field,stat(density))) + 
  geom_histogram(alpha=0.4,position="Identity")
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /&gt;
In this case: not particularly helpful. `freqpoly` is better here.

---

## ggplot: Side-By-Side Boxplots


```r
ggplot(data=df,mapping=aes(x=field,y=mass)) + geom_boxplot(fill="FireBrick2") 
```

&lt;img src="Notes_02R-Rggplot_files/figure-html/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
